!function(){for(var M=800,F=600,p=150,u=p*p,a=100,r=.05,e=.1,S=.5,t=1,w=5,o,P=document.getElementById("charges").getContext("2d"),T=[],l=0;l<a;l++){var n=Math.random()*Math.PI*2,h=r+.05*Math.random();T.push({charge:l%2,x:-p+Math.random()*(M+2*p),y:-p+Math.random()*(F+2*p),vel:{x:h*Math.cos(n),y:h*Math.sin(n)},mass:1+Math.random()*(w-1)})}var b=(new Date).getTime();function C(){requestAnimationFrame(C);var a=(new Date).getTime(),r=(a-b)/16;b=a;for(var e=0;e<T.length;e++)for(var t=T[e],o=0;o<T.length;o++)if(e!==o){var l,n=(l=T[o]).x-t.x,h=l.y-t.y,v;if(!((v=n*n+h*h)<5)){var i,y=S*t.mass*l.mass/v/t.mass;t.charge==l.charge&&(y*=-1);var f=Math.sqrt(v),g=n/f,x=h/f;t.vel.x+=y*g,t.vel.y+=y*x}}for(var e=0;e<T.length;e++){var t;for((t=T[e]).x+=r*t.vel.x,t.y+=r*t.vel.y;t.x<-p;)t.x+=M+2*p;for(;M+p<t.x;)t.x-=M+2*p;for(;t.y<-p;)t.y+=F+2*p;for(;F+p<t.y;)t.y-=F+2*p}P.fillStyle="#112222",P.fillRect(0,0,M,F);var s=function(a){return a?"#66FFFF":"#FF6666"};P.lineWidth=1;for(var e=0;e<T.length;e++)for(var t=T[e],o=0;o<T.length;o++){var l=T[o],v,m=1-(v=Math.pow(t.x-l.x,2)+Math.pow(t.y-l.y,2))/u;if(!(m<0)){var c=P.createLinearGradient(t.x,t.y,l.x,l.y);c.addColorStop(0,s(t.charge)),c.addColorStop(1,s(l.charge)),P.strokeStyle=c,P.globalAlpha=Math.pow(m,10),P.beginPath(),P.moveTo(t.x,t.y),P.lineTo(l.x,l.y),P.stroke()}}P.fillStyle="#99FFFF";for(var e=0;e<T.length;e++){var t,d=2+(t=T[e]).mass/w;P.fillStyle=s(t.charge),P.beginPath(),P.arc(t.x,t.y,d,0,2*Math.PI),P.fill()}}C()}();